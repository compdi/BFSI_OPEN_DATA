<!DOCTYPE html>
<html>
<head>
  <title>BFSI Open Data</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Data essays, dashboards, and storytelling from the Indian BFSI world. Built by experts, designed for the underserved.">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6DWB0Q3MJB"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-6DWB0Q3MJB');
  </script>

  <style>
    :root {
      --bg-color: #ffffff;
      --text-color: #2c3e50;
      --card-bg: #ffffff;
      --card-border: #e7e7e7;
      --muted: #666;
    }

    html { scroll-behavior: smooth; }

    body.dark-theme {
      --bg-color: #121212;
      --text-color: #ffffff;
      --card-bg: #1b1b1b;
      --card-border: #2a2a2a;
      --muted: #aaa;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s;
    }

    /* Navbar */
    .navbar {
      position: absolute;
      top: 0; left: 0; width: 100%;
      display: flex; justify-content: space-between; align-items: center;
      padding: 10px 20px; z-index: 2;
    }
    .navbar img {
      height: 110px; background: white; padding: 10px; border-radius: 10px;
      box-shadow: 0 0 8px rgba(0,0,0,0.2);
    }
    .navbar-right { margin-right: 20px; }
    .theme-toggle {
      padding: 6px 12px;
      background: #fff; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; font-size: 0.9em;
    }
    body.dark-theme .theme-toggle { background: #333; color: #fff; border-color: #666; }

    /* Floating socials */
    .social-floating {
      position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 999;
    }
    .social-icon { width: 40px; height: 40px; }

    /* Header hero */
    header {
      background-color: transparent; padding: 80px 20px 40px; text-align: center;
    }
    header h1 { font-size: 3.5em; margin-bottom: 10px; }
    header p { font-size: 1.1em; margin: 0 auto; }
    .cta-button {
      display: inline-block; margin-top: 25px; padding: 12px 20px;
      background-color: #0077cc; color: white; font-weight: bold; text-decoration: none;
      border-radius: 8px; transition: background-color 0.3s;
    }
    .cta-button:hover { background-color: #005fa3; }

    /* Main container */
    .content {
      max-width: 1200px;
      margin: 20px auto;
      padding: 0 20px;
    }

    /* Left-right layout */
    .bc-layout {
      display: grid;
      grid-template-columns: 360px 1fr;
      gap: 16px; align-items: start;
    }
    @media (max-width: 960px){
      .bc-layout{ grid-template-columns: 1fr; }
    }

    /* Left card (search widget) */
    .bc-left { position: sticky; top: 12px; }
    .bc-card {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 1px 4px rgba(0,0,0,.04);
    }
    .bc-title { margin: 0 0 10px; font-size: 18px; }
    .bc-field { margin-bottom: 10px; }
    .bc-field label { display:block; font-size: 12px; opacity: .8; margin-bottom: 4px; }
    .bc-field input {
      width:100%; padding:8px; border:1px solid #d8d8d8; border-radius: 8px;
      background: var(--bg-color); color: var(--text-color);
    }
    .bc-grid { display:grid; grid-template-columns: 1fr 1fr; gap:8px; }
    .bc-actions { display:flex; gap:8px; margin: 8px 0 6px; }
    .bc-actions button {
      padding:8px 12px; border-radius:10px; border:1px solid #bbb; background:#f8f8f8; cursor:pointer;
    }
    .bc-actions .ghost { background:transparent; }
    .bc-meta { font-size: 12px; opacity: .8; margin: 4px 0 8px; }
    .bc-table-wrap { border:1px solid #eee; border-radius: 10px; overflow: auto; }
    .bc-table { width:100%; border-collapse: collapse; table-layout: fixed; user-select: none; }
    .bc-table th, .bc-table td { border-bottom:1px solid #f0f0f0; padding:8px; vertical-align: top; }
    .bc-table th { text-align:left; font-size:12px; opacity:.7; }
    .bc-table td { font-size: 13px; }
    .bc-pagination { display:flex; align-items:center; gap:10px; justify-content:center; padding:8px 0; }
    .bc-note { font-size: 12px; opacity:.7; margin-top: 8px; }

    /* Right side content (your existing sections) */
    .section { margin-bottom: 20px; }
    h2 { color: var(--text-color); }
    a { color: #0077cc; text-decoration: none; }
    a:hover { text-decoration: underline; }

    iframe {
      width: 100%; height: 700px; border: 0; border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); margin-bottom: 10px;
    }
    .disclaimer { font-size: 12px; color: var(--muted); margin-top: 5px; }

    footer {
      text-align: center; font-size: 0.8em; color: #999; padding: 10px 0; margin-top: 10px;
    }

    /* Mobile tweaks */
    @media only screen and (max-width: 768px) {
      header h1 { font-size: 2.2em; }
      .cta-button { font-size: 1em; padding: 10px 16px; }
      iframe { height: 450px; margin-bottom: 10px; }
      .navbar img { height: 80px; }
      .navbar { padding: 6px 12px; }
      .navbar-right { margin-right: 10px; }
      .social-icon { width: 30px; height: 30px; }
      .content { padding: 0 10px; }
      .section { margin-bottom: 15px; }
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <div class="navbar">
    <a href="/"><img src="Logo.png" alt="BFSI Open Data Logo"></a>
    <div class="navbar-right">
      <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
    </div>
  </div>

  <!-- Floating social -->
  <div class="social-floating">
    <a href="https://www.linkedin.com/company/bfsi-open-data/?viewAsMember=true" target="_blank"><img class="social-icon" src="https://cdn-icons-png.flaticon.com/512/145/145807.png" alt="LinkedIn"></a>
    <a href="https://www.instagram.com/bfsi_open_data/" target="_blank"><img class="social-icon" src="https://cdn-icons-png.flaticon.com/512/174/174855.png" alt="Instagram"></a>
    <a href="https://x.com/bfsiopendata" target="_blank"><img class="social-icon" src="https://cdn-icons-png.flaticon.com/512/733/733579.png" alt="Twitter/X"></a>
  </div>

  <!-- Hero -->
  <header>
    <h1>BFSI Open Data</h1>
    <p><strong>Insurance & Financial Services Expert | Strategist | Advocate for the Underserved</strong></p>
    <a href="#gi-dashboard" class="cta-button">ðŸ“ˆ Explore General Insurance Dashboard â†’</a>
  </header>

  <!-- Main two-column area -->
  <div id="main" class="content">
    <div class="bc-layout">
      <!-- LEFT: Blacklisted/Delisted Hospitals search -->
      <aside class="bc-left">
        <div class="bc-card">
          <h3 class="bc-title">Blacklisted / Delisted Hospitals</h3>

          <div class="bc-field">
            <label>Search (min 3 chars)</label>
            <input id="bc-q" type="text" placeholder="Hospital, company, city, state, PIN" autocomplete="off">
          </div>

          <div class="bc-grid">
            <div class="bc-field">
              <label>Company</label>
              <input id="bc-company" type="text" placeholder="e.g., Star, Niva">
            </div>
            <div class="bc-field">
              <label>State</label>
              <input id="bc-state" type="text" placeholder="Exact (e.g., Maharashtra)">
            </div>
            <div class="bc-field">
              <label>City</label>
              <input id="bc-city" type="text" placeholder="Exact (e.g., Pune)">
            </div>
            <div class="bc-field">
              <label>PIN</label>
              <input id="bc-pin" type="text" inputmode="numeric" pattern="[0-9]*" maxlength="6" placeholder="6-digit">
            </div>
          </div>

          <div class="bc-actions">
            <button id="bc-search">Search</button>
            <button id="bc-clear" class="ghost">Clear</button>
          </div>

          <div id="bc-meta" class="bc-meta"></div>

          <div class="bc-table-wrap">
            <table class="bc-table" aria-label="Blacklisted hospitals search results">
              <thead>
                <tr>
                  <th>Hospital</th>
                  <th>Company</th>
                  <th>City</th>
                  <th>State</th>
                  <th>PIN</th>
                  <th>Address</th>
                </tr>
              </thead>
              <tbody id="bc-tbody"></tbody>
            </table>
          </div>

          <div class="bc-pagination">
            <button id="bc-prev" disabled>Prev</button>
            <span id="bc-pageinfo">Page 1</span>
            <button id="bc-next" disabled>Next</button>
          </div>

          <p class="bc-note">Search-only view. Bulk export disabled.</p>
        </div>
      </aside>

      <!-- RIGHT: your existing BFSI sections unchanged -->
      <main class="bc-right">
        <div class="section">
          <p><strong>Insurance | Financial data | News | Analysis | Storytelling using Data</strong></p>
        </div>

        <div class="section" id="gi-dashboard">
          <h2>General Insurance Dashboard</h2>
          <p>This dashboard presents an insurer-wise snapshot of gross premium numbers across Motor, Health, and Personal Accident lines. Filter and explore by Year or Insurer.</p>
          <iframe src="https://lookerstudio.google.com/embed/reporting/b311387f-204c-489a-879d-5f8594c5019e/page/RA7LF"
                  allowfullscreen sandbox="allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox">
          </iframe>
          <p class="disclaimer"><strong>Disclaimer:</strong> The information and visuals presented in this dashboard are compiled from publicly available data sources and are intended for general informational purposes only.</p>
        </div>

        <div class="section">
          <h2>Letâ€™s Connect</h2>
          <p>Reach out to collaborate or discuss ideas. ðŸ“§ <a href="mailto:bfsiopendata@gmail.com">bfsiopendata@gmail.com</a></p>
        </div>
      </main>
    </div>
  </div>

  <footer>
    &copy; 2025 BFSI Open Data Â· All rights reserved
  </footer>

  <script>
    function toggleTheme() {
      document.body.classList.toggle('dark-theme');
    }
  </script>

  <!-- Search widget logic -->
  <script>
  (function(){
    const API = 'https://script.google.com/macros/s/AKfycbz-AndCEBjN36GZnfrqL6XEKoY9UhG4m7_-cwM_27Hh95Yo5RkSg2kQPFRTSOpPLcXg/exec';

    const els = {
      q:       document.getElementById('bc-q'),
      company: document.getElementById('bc-company'),
      state:   document.getElementById('bc-state'),
      city:    document.getElementById('bc-city'),
      pin:     document.getElementById('bc-pin'),
      search:  document.getElementById('bc-search'),
      clear:   document.getElementById('bc-clear'),
      tbody:   document.getElementById('bc-tbody'),
      meta:    document.getElementById('bc-meta'),
      prev:    document.getElementById('bc-prev'),
      next:    document.getElementById('bc-next'),
      pageinfo:document.getElementById('bc-pageinfo')
    };

    let page = 1;
    const pageSize = 10;
    let total = 0;

    function params() {
      const p = new URLSearchParams();
      const v = (x)=> (x||'').trim();
      if (v(els.q.value))       p.set('q', v(els.q.value));
      if (v(els.company.value)) p.set('company', v(els.company.value));
      if (v(els.state.value))   p.set('state', v(els.state.value));
      if (v(els.city.value))    p.set('city', v(els.city.value));
      if (v(els.pin.value))     p.set('pin', v(els.pin.value));
      p.set('page', page);
      p.set('pageSize', pageSize);
      return p.toString();
    }

    async function runSearch() {
      const cols = 6;
      els.tbody.innerHTML = `<tr><td colspan="${cols}">Searchingâ€¦</td></tr>`;
      try {
        const res = await fetch(`${API}?${params()}`);
        const data = await res.json();

        if (data.error) {
          els.meta.textContent = data.error;
          els.tbody.innerHTML = '';
          total = 0;
          updatePager();
          return;
        }

        total = data.total || 0;
        const rows = data.results || [];
        els.meta.textContent = `${total} result${total===1?'':'s'} found`;
        els.tbody.innerHTML = rows.map(r => `
          <tr>
            <td>${escapeHtml(r.hospital || '')}</td>
            <td>${escapeHtml(r.company || '')}</td>
            <td>${escapeHtml(r.city || '')}</td>
            <td>${escapeHtml(r.state || '')}</td>
            <td>${escapeHtml(r.pin || '')}</td>
            <td>${escapeHtml(r.address || '')}</td>
          </tr>
        `).join('') || `<tr><td colspan="${cols}">No results</td></tr>`;
        updatePager();
      } catch (e) {
        els.meta.textContent = 'Network error. Try again.';
        els.tbody.innerHTML = '';
        total = 0;
        updatePager();
      }
    }

    function escapeHtml(s) {
      return (s+'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    }

    function updatePager() {
      const pages = Math.max(1, Math.ceil(total / pageSize));
      els.pageinfo.textContent = `Page ${page} of ${pages}`;
      els.prev.disabled = (page <= 1);
      els.next.disabled = (page >= pages);
    }

    function clearAll() {
      els.q.value = els.company.value = els.state.value = els.city.value = els.pin.value = '';
      page = 1;
      els.meta.textContent = '';
      els.tbody.innerHTML = '';
      updatePager();
    }

    let t;
    els.q.addEventListener('input', () => { page = 1; clearTimeout(t); t = setTimeout(runSearch, 350); });
    els.search.addEventListener('click', () => { page = 1; runSearch(); });
    els.clear.addEventListener('click', clearAll);
    els.prev.addEventListener('click', () => { if (page>1){ page--; runSearch(); } });
    els.next.addEventListener('click', () => { page++; runSearch(); });
  })();
  </script>
</body>
</html>
